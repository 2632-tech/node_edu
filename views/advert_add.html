{% extends "layout.html" %}

{% block body %}
<div class="container-fluid">
	<div class="body advert">
		<!-- 面包屑 -->
		<ol class="breadcrumb">
			<li><a href="javascript:;">广告管理</a></li>
			<li class="active">添加广告</li>
		</ol>
		<div class="advert-add">
			<form action="/advert/add" method="post" class="form-horizontal" enctype="multipart/form-data">
				<div class="form-group">
					<label for="" class="col-md-3 control-label">名称</label>
					<div class="col-md-5">
						<input type="text" required name="title" class="form-control input-sm" placeholder="填写广告名称">
					</div>
				</div>
				<div class="form-group">
					<label for="" class="col-md-3 control-label">广告图片</label>
					<div class="col-md-5">
						<input type="file" required name="image" id="file" class="form-control input-sm" name="image" placeholder="填写广告图片地址">
					</div>
				</div>
				<div class="form-group">
					<label for="" class="col-md-3 control-label">广告链接</label>
					<div class="col-md-5">
						<input type="text" required name="link" class="form-control input-sm" placeholder="填写广告链接">
					</div>
				</div>
				<div class="form-group">
					<label for="" class="col-md-3 control-label">开始时间</label>
					<div class="col-md-5">
						<input type="text" required name="start_time" class="form-control input-sm" placeholder="填写开始时间">
					</div>
				</div>
				<div class="form-group">
					<label for="" class="col-md-3 control-label">结束时间</label>
					<div class="col-md-5">
						<input type="text" required name="end_time" class="form-control input-sm" placeholder="填写结束时间">
					</div>
				</div>
				<div class="form-group">
					<div class="col-md-8">
						<input type="submit" class="btn btn-success btn-sm pull-right" value="保存"/>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">

	$('form').on('submit',function(e){
		
		// var formData = new FormData()
		// formData.append('name','nih')
		// formData.append('age','1')
		// formData.append('file',document.getElementById('file').files[0])
		
		// var xhr = new XMLHttpRequest()
		// xhr.open('post','/advert/add')
		// xhr.send(formData)
		// return false
		$.ajax({
			url:$(this).attr('action'),
			type:$(this).attr('method'),
			data:new FormData($(this)[0]),
			// processData设置为false jQuery异步请求才会生效
			processData:false,
			//当提交一个formdata对象的时候记得将contentType设置为false
			contentType:false,
			success:function(data){
				if(data.err_code === 0){
					window.location.href='/advert'
				}
			}
		})
		return false 
	})
		
	
</script>
{% endblock %} 